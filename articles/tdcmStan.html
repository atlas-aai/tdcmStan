<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="tdcmStan">
<title>Using tdcmStan • tdcmStan</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using tdcmStan">
<meta property="og:description" content="tdcmStan">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">tdcmStan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/tdcmStan.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/atlas-aai/tdcmStan/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using tdcmStan</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/atlas-aai/tdcmStan/blob/HEAD/vignettes/tdcmStan.Rmd" class="external-link"><code>vignettes/tdcmStan.Rmd</code></a></small>
      <div class="d-none name"><code>tdcmStan.Rmd</code></div>
    </div>

    
    
<p>Transition diagnostic classification models (TDCMs) are psychometric
models that estimate respondents latent class membership longitudinally
<span class="citation">(<a href="#ref-tdcm">Madison &amp; Bradshaw,
2018</a>)</span>. TDCMs are commonly estimated using the maximum
likelihood algorithm. However, there are benefits to estimating Bayesian
models <span class="citation">(e.g., <a href="#ref-zhan_2019">Zhan et
al., 2019</a>)</span>, and we can use <em>Stan</em> to estimate Bayesian
TDCMs. The problem is that developing <em>Stan</em> code is both time
intensive and requires significant technical expertise.</p>
<p>We aimed to address that problem through the tdcmStan package. The
goal of tdcmStan is to facilitate the production of <em>Stan</em> code
for estimating TDCMs. The tdcmStan packages creates the <em>Stan</em>
code for estimating a TDCM, without requiring extensive knowledge of
<em>Stan</em> syntax. For those with experience in producing
<em>Stan</em> syntax, the <em>Stan</em> code produced by the tdcmStan
package can be further editted to meet specific needs.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="tdcmstan">tdcmStan<a class="anchor" aria-label="anchor" href="#tdcmstan"></a>
</h3>
<p>You can install the release version of tdcmStan from <a href="https://cran.r-project.org/" class="external-link">CRAN</a>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tdcmStan"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version from <a href="https://github.com/atlas-aai/tdcmStan" class="external-link">GitHub</a> use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"atlas-aai/tdcmStan"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="rstan-and-cmdstanr">rstan and cmdstanr<a class="anchor" aria-label="anchor" href="#rstan-and-cmdstanr"></a>
</h3>
<p>To estimate models using <em>Stan</em> code, users will need an
installation of <a href="https://mc-stan.org/rstan/" class="external-link">rstan</a> or <a href="https://mc-stan.org/cmdstanr/" class="external-link">cmdstanr</a>. The instructions for
installing rstan can be found here: <a href="https://github.com/stan-dev/rstan/wiki/RStan-Getting-Started" class="external-link">RStan
Getting Started</a> for <a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Windows" class="external-link">Windows</a>,
<a href="https://github.com/stan-dev/rstan/wiki/Configuring-C---Toolchain-for-Mac" class="external-link">Mac</a>,
and <a href="https://github.com/stan-dev/rstan/wiki/Configuring-C-Toolchain-for-Linux" class="external-link">Linux</a>.
The instructions for installing cmdstanr can be found here: <a href="https://mc-stan.org/cmdstanr/articles/cmdstanr.html" class="external-link">Getting
Started with CmdStanR</a>. A full demonstration of how to install and
use rstan and cmdstanr is outside of the scope of this vignette.</p>
</div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Once tdcmStan has been installed, we are ready to create
<em>Stan</em> code for estimating a TDCM.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/atlas-aai/tdcmStan" class="external-link">tdcmStan</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="tdcm">TDCM<a class="anchor" aria-label="anchor" href="#tdcm"></a>
</h3>
<p>To demonstrate the workflow using tdcmStan, we present an example
case for generating <em>Stan</em> code. For this example, we will assume
that we are going to be estimating a TDCM for a 5-item 1-attribute
assessment that is administered at two time points. In our example, the
resulting <em>Stan</em> code is first saved in the
<code>stan_code</code> object, and then the <em>Stan</em> code is saved
as a .stan file where it can be read in for model estimation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">q_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">stan_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_stan_tdcm.html">create_stan_tdcm</a></span><span class="op">(</span><span class="va">q_matrix</span><span class="op">)</span></span>
<span><span class="va">stan_code</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_lines.html" class="external-link">write_lines</a></span><span class="op">(</span><span class="fu">here</span><span class="op">(</span><span class="st">"Stan/tdcm.stan"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To be consistent with the assumption of item invariance described in
-<span class="citation">Madison &amp; Bradshaw (<a href="#ref-tdcm">2018</a>)</span>, the <code><a href="../reference/create_stan_tdcm.html">create_stan_tdcm()</a></code>
function estimates item parameters such that the parameter values for
each item are the same at Time 1 and Time 2.</p>
</div>
<div class="section level3">
<h3 id="multi-threaded-tdcm">Multi-Threaded TDCM<a class="anchor" aria-label="anchor" href="#multi-threaded-tdcm"></a>
</h3>
<p>In many cases, the process for estimating Bayesian TDCMs may be time
intensive. To work around this, we can use estimate the TDCM with
multi-threading, which uses parallel processes to increase estimation
efficiency and to reduce estimation time.</p>
<p>To estimate a TDCM with multi-threading, we would run:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fng_stan_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_threaded_stan_tdcm.html">create_threaded_stan_tdcm</a></span><span class="op">(</span><span class="va">q_matrix</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="calculating-the-number-of-shards">Calculating the Number of Shards<a class="anchor" aria-label="anchor" href="#calculating-the-number-of-shards"></a>
</h3>
<p>The number of shards refers to the number of parallel processes that
are used in a multi-threaded TDCM. The tdcmStan package includes a
<code><a href="../reference/shard_calculator.html">shard_calculator()</a></code> function to automatically calculate how
many shards can be used. To do this, we run:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">num_respondents</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">num_responses</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">num_chains</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="fu"><a href="../reference/shard_calculator.html">shard_calculator</a></span><span class="op">(</span><span class="va">num_respondents</span>, <span class="va">num_responses</span>, <span class="va">num_chains</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fungible-tdcm">Fungible TDCM<a class="anchor" aria-label="anchor" href="#fungible-tdcm"></a>
</h3>
<p>The tdcmStan package follows a similar process for producing
<em>Stan</em> code for TDCMs with other constraints. In addition to the
assumption of item invariance across time points, we can assume item
fungibility. Fungibility means that the items measuring an attribute are
assumed to have the same item parameter values. For example, in our
running example, all five items measure the attribute. In a fungible
model, this means that there will be one shared item intercept parameter
and one shared item main effect parameter for all five items.</p>
<p>To estimate a fungible TDCM for this 5-item 1-attribute assessment,
we would run:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fng_stan_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_fng_stan_tdcm.html">create_fng_stan_tdcm</a></span><span class="op">(</span><span class="va">q_matrix</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fungible-tdcm-with-no-common-items">Fungible TDCM with No Common Items<a class="anchor" aria-label="anchor" href="#fungible-tdcm-with-no-common-items"></a>
</h3>
<p>The previous examples have created <em>Stan</em> code for estimating
a TDCM under the assumption that the respondents are completing the same
items at each assessment point; however, this may not always be the case
for assessment programs. Some assessment programs may only allow
respondents to complete each item once.</p>
<p>To estimate a fungible TDCM for a 1-attribute assessment where
respondents complete different items at each assessment point, we would
run:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">q_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fng_no_cmn_items_stan_code</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_fng_no_common_item_tdcm.html">create_fng_no_common_item_tdcm</a></span><span class="op">(</span><span class="va">q_matrix</span><span class="op">)</span></span></code></pre></div>
<p>In this example, the assessment consists of five items that are
completed at each time point, but respondents do not complete the same
item twice. This means that respondents would be completing five of the
items at Time 1 and the other five items at Time 2, and the items
completed at Time 1 do not necessarily have to be consistent across all
of the respondents. For example, Respondent 1 might complete Items 2, 4,
6, 8, and 10 at Time 1 and the remaining items at Time 2, while
Respondent 2 might complete Items 1, 2, 3, 4, and 5 at Time 1 and the
remaining items at Time 2.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-tdcm" class="csl-entry">
Madison, M. J., &amp; Bradshaw, L. P. (2018). Assessing growth in a
diagnostic classification model framework. <em>Psychometrika</em>,
<em>83</em>, 963–990. <a href="https://doi.org/10.1007/s11336-018-9638-5" class="external-link">https://doi.org/10.1007/s11336-018-9638-5</a>
</div>
<div id="ref-zhan_2019" class="csl-entry">
Zhan, P., Jiao, H., Man, K., &amp; Wang, L. (2019). Using JAGS for
bayesian cognitive diagnosis modeling: A tutorial. <em>Journal of
Educational and Behavioral Statistics</em>, <em>44</em>(4), 473–503. <a href="https://doi.org/10.3102/1076998619826040" class="external-link">https://doi.org/10.3102/1076998619826040</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jeffrey Hoover, W. Jake Thompson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
